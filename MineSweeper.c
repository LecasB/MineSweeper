#include <stdio.h>
#include <time.h>
#include <stdlib.h>
#include <string.h>

char matrixReal[17][17][3] = {
    {"  ", "01", "02", "03", "04", "05", "06", "07", "08", "09", "10", "11", "12", "13", "14", "15", "16"},
    {"01", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--"},
    {"02", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--"},
    {"03", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--"},
    {"04", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--"},
    {"05", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--"},
    {"06", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--"},
    {"07", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--"},
    {"08", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--"},
    {"09", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--"},
    {"10", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--"},
    {"11", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--"},
    {"12", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--"},
    {"13", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--"},
    {"14", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--"},
    {"15", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--"},
    {"16", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--"}};

void GerarMinas()
{
    srand(time(NULL));

    int N_bombas = 0;

    do
    {
        int linha = rand() % 16;
        int coluna = rand() % 16;

        if (strcmp(matrixReal[linha][coluna], "--") == 0)
        {
            N_bombas++;
            strcpy(matrixReal[linha][coluna], "XX");
            
        }
            
        
            
    } while (N_bombas < 51);
}

void verificarMinas()
{
    
    char numposChar[3];
    for (int i=1;i<17;i++){
        for (int j=1;j<17;j++){
            int numpos=10;
            

            if (strcmp(matrixReal[i-1][j-1], "XX") == 0){
                numpos++;
            }
            if (strcmp(matrixReal[i-1][j], "XX") == 0){
                numpos++;
            }
            if (strcmp(matrixReal[i-1][j+1], "XX") == 0){
                numpos++;
            }
            if (strcmp(matrixReal[i][j-1], "XX") == 0){
                numpos++;
            }
            if (strcmp(matrixReal[i][j+1], "XX") == 0){
                numpos++;
            }
            if (strcmp(matrixReal[i+1][j-1], "XX") == 0){
                numpos++;
            }
            if (strcmp(matrixReal[i+1][j], "XX") == 0){
                numpos++;
            }
            if (strcmp(matrixReal[i+1][j+1], "XX") == 0){
                numpos++;
            }
            sprintf(numposChar, "%d", numpos);
                //printf("%d \n",numpos);
            if (strcmp(matrixReal[i][j], "XX") == 0){
            
            }else{
            strcpy(matrixReal[i][j], numposChar);
            }

            if (strcmp(matrixReal[i][j], "10") == 0)
            strcpy(matrixReal[i][j], "--");
        }
    }
    }

int main()
{
    int op = 0;

    do
    {
        printf("|------- MENU ---------|\n");
        printf("|--- 1 - Jogar --------|\n");
        printf("|--- 2 - Instruções ---|\n");
        printf("|--- 3 - Sair ---------|\n");
        scanf("%d", &op);

    } while (op < 0 || op > 3);

    if (op == 2)
    {
        printf("Adoro Consistencia :) !");
    }

    if (op == 3)
    {
        printf("Obrigado por ter jogado :) !");
    }

    if (op == 1)
    {
        GerarMinas();
        verificarMinas();
        for (int i = 0; i < 17; i++)
        {
            for (int j = 0; j < 17; j++)
            {
                 if (strcmp(matrixReal[i][j],"XX") == 0){
                    printf("\033[0;31m");
                }else if (strcmp(matrixReal[i][j],"--") == 0){
                    printf("\033[0;34m");
                }else{
                    printf("\033[0;37m");
                }

                  
                printf("%s ", matrixReal[i][j]);
                
                
            }
            printf("\n");
        }
    }
    printf("\033[0;37m");
}
